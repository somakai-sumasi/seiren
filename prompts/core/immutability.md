---
name: immutability
category: core
description: 不変性の定義と判断基準
---

## 不変性の定義と判断基準

### 定義
不変性（イミュータビリティ）とは、一度生成されたオブジェクトの状態が変更されないことを保証する設計原則。
再代入や状態変更を防ぐことで、予期せぬ副作用を排除し、コードの安定動作を獲得する。

### 判断基準
1. **再代入の有無**
   - 変数への再代入が行われていないか
   - ループ内での変数更新が必要最小限か

2. **オブジェクトの状態変更**
   - setterメソッドが存在しないか
   - フィールドがfinal/readonly宣言されているか

3. **不変オブジェクトの活用**
   - 値の変更時に新しいインスタンスを返しているか
   - コンストラクタで全ての状態が確定しているか

4. **可変コレクションの扱い**
   - コレクションが外部から変更可能な状態で公開されていないか
   - 防御的コピーが適切に行われているか

### 欠陥パターン
- 変数への複数回の再代入
- setterによる状態変更の許可
- ミュータブルなフィールドの公開
- 引数で受け取ったオブジェクトの直接変更
